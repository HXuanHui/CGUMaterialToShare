A51 MACRO ASSEMBLER  LED_SHIFT                                                            10/24/2022 22:38:34 PAGE     1


MACRO ASSEMBLER A51 V8.2.7.0
OBJECT MODULE PLACED IN LED_shift.OBJ
ASSEMBLER INVOKED BY: C:\Keil\C51\BIN\A51.EXE LED_shift.asm XR GEN DB EP NOMOD51 INCDIR(C:\SiLabs\MCU\Inc) 

LOC  OBJ            LINE     SOURCE

                       1     ;define control registers (with address)
  00E3                 2     XBR2            equ             0e3h
  00AD                 3     P1MDIN          equ             0adh
  00A6                 4     P2MDOUT         equ             0a6h
  00FF                 5     WDTCN           equ             0ffh
  0084                 6     SFRPAGE         equ             084h
  0090                 7     P1                      equ             090h
  00A0                 8     P2                      equ             0a0h
                       9     
                      10     ;define control registers for timer control
  0089                11     TMOD            equ             089h
  0088                12     TCON            equ             088h
  008E                13     CKCON           equ             08eh
  00A8                14     IE                      equ             0a8h
  008A                15     TL0                     equ             08ah
  008C                16     TH0                     equ             08ch
                      17     
                      18     ;define control words
  000F                19     CONFIG_PAGE             equ             0fh
  0000                20     LEGACY_PAGE             equ             00h
                      21     
0000                  22                     org             0h
0000 020100           23                     ljmp    main
                      24     
000B                  25                     org             0bh
000B 020137           26                     ljmp    Timer0_ISR
                      27     
0100                  28                     org             0100h
0100                  29     main:
0100 12010E           30                     lcall   Port_Config
0103 120124           31                     lcall   Timer_Config
0106 7804             32                     mov             R0, #4                  ;the ISR entrance count
0108 7980             33                     mov             R1, #80h                ;the LED pattern to display
010A                  34     loop:   
010A 89A0             35                     mov             P2, R1
010C 80FC             36                     sjmp    loop
                      37     
010E                  38     Port_Config:
                      39                     ;turn-off the watch-dog timer
010E 75FFDE           40                     mov             WDTCN, #0deh
0111 75FFAD           41                     mov             WDTCN, #0adh
                      42     
                      43                     ;setup port configuration
0114 75840F           44                     mov             SFRPAGE, #CONFIG_PAGE
0117 75E3C0           45                     mov             XBR2, #0c0h
011A 75ADFF           46                     mov             P1MDIN, #0ffh
011D 75A6FF           47                     mov             P2MDOUT, #0ffh
0120 758400           48                     mov             SFRPAGE, #LEGACY_PAGE
0123 22               49                     ret
                      50     
0124                  51     Timer_Config:
0124 758901           52                     mov             TMOD, #01h
0127 758810           53                     mov             TCON, #010h
012A 758E10           54                     mov             CKCON, #010h
012D 75A882           55                     mov             IE, #082h
0130 758A00           56                     mov             TL0, #0
0133 758C00           57                     mov             TH0, #0
0136 22               58                     ret
A51 MACRO ASSEMBLER  LED_SHIFT                                                            10/24/2022 22:38:34 PAGE     2

                      59     
0137                  60     Timer0_ISR:
0137 D805             61                     DJNZ    R0, reset_timer
                      62     
0139 7804             63                     mov             R0, #4
013B E9               64                     mov             A, R1
013C 23               65                     RL              A
013D F9               66                     mov             R1, A
                      67     
013E                  68     reset_timer:
013E 758A00           69                     mov             TL0, #0
0141 758C00           70                     mov             TH0, #0
0144 32               71                     reti
                      72                     end
                             
                             
                             
                             
                             
                             
                             
                             
A51 MACRO ASSEMBLER  LED_SHIFT                                                            10/24/2022 22:38:34 PAGE     3

XREF SYMBOL TABLE LISTING
---- ------ ----- -------


N A M E             T Y P E  V A L U E   ATTRIBUTES / REFERENCES

CKCON. . . . . . .  N NUMB   008EH   A      13# 54
CONFIG_PAGE. . . .  N NUMB   000FH   A      19# 44
IE . . . . . . . .  N NUMB   00A8H   A      14# 55
LEGACY_PAGE. . . .  N NUMB   0000H   A      20# 48
LOOP . . . . . . .  C ADDR   010AH   A      34# 36
MAIN . . . . . . .  C ADDR   0100H   A      23 29#
P1 . . . . . . . .  N NUMB   0090H   A      7#
P1MDIN . . . . . .  N NUMB   00ADH   A      3# 46
P2 . . . . . . . .  N NUMB   00A0H   A      8# 35
P2MDOUT. . . . . .  N NUMB   00A6H   A      4# 47
PORT_CONFIG. . . .  C ADDR   010EH   A      30 38#
RESET_TIMER. . . .  C ADDR   013EH   A      61 68#
SFRPAGE. . . . . .  N NUMB   0084H   A      6# 44 48
TCON . . . . . . .  N NUMB   0088H   A      12# 53
TH0. . . . . . . .  N NUMB   008CH   A      16# 57 70
TIMER0_ISR . . . .  C ADDR   0137H   A      26 60#
TIMER_CONFIG . . .  C ADDR   0124H   A      31 51#
TL0. . . . . . . .  N NUMB   008AH   A      15# 56 69
TMOD . . . . . . .  N NUMB   0089H   A      11# 52
WDTCN. . . . . . .  N NUMB   00FFH   A      5# 40 41
XBR2 . . . . . . .  N NUMB   00E3H   A      2# 45


REGISTER BANK(S) USED: 0 


ASSEMBLY COMPLETE.  0 WARNING(S), 0 ERROR(S)
